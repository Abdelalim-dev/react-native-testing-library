(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{56:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return c})),n.d(t,"rightToc",(function(){return s})),n.d(t,"default",(function(){return p}));var a=n(1),r=n(6),i=(n(0),n(78)),o={id:"react-navigation",title:"React Navigation"},c={unversionedId:"react-navigation",id:"react-navigation",isDocsHomePage:!1,title:"React Navigation",description:"This section deals with integrating @testing-library/react-native with react-navigation, using Jest.",source:"@site/docs/ReactNavigation.md",permalink:"/react-native-testing-library/docs/react-navigation",editUrl:"https://github.com/callstack/react-native-testing-library/blob/master/docs/ReactNavigation.md",sidebar:"docs",previous:{title:"How Should I Query?",permalink:"/react-native-testing-library/docs/how-should-i-query"},next:{title:"Redux Integration",permalink:"/react-native-testing-library/docs/redux-integration"}},s=[{value:"Setting up",id:"setting-up",children:[]},{value:"Setting up the test environment",id:"setting-up-the-test-environment",children:[]},{value:"Running tests",id:"running-tests",children:[]}],l={rightToc:s};function p(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(a.a)({},l,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"This section deals with integrating ",Object(i.b)("inlineCode",{parentName:"p"},"@testing-library/react-native")," with ",Object(i.b)("inlineCode",{parentName:"p"},"react-navigation"),", using Jest."),Object(i.b)("h2",{id:"setting-up"},"Setting up"),Object(i.b)("p",null,"Install the packages required for React Navigation. For this example, we will use a ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://reactnavigation.org/docs/stack-navigator/"}),"stack navigator")," to transition to the second page when any of the items are clicked on."),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"$ yarn add @react-native-community/masked-view @react-navigation/native @react-navigation/stack react-native-gesture-handler react-native-reanimated react-native-safe-area-context react-native-screens\n")),Object(i.b)("p",null,"Create an ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/callstack/react-native-testing-library/blob/master/examples/reactnavigation/src/AppNavigator.js"}),Object(i.b)("inlineCode",{parentName:"a"},"./AppNavigator.js"))," component which will list the navigation stack:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-jsx"}),"import 'react-native-gesture-handler';\nimport * as React from 'react';\nimport { createStackNavigator } from '@react-navigation/stack';\n\nimport HomeScreen from './screens/HomeScreen';\nimport DetailsScreen from './screens/DetailsScreen';\n\nconst { Screen, Navigator } = createStackNavigator();\n\nexport default function Navigation() {\n  const options = {};\n\n  return (\n    <Navigator>\n      <Screen name=\"Home\" component={HomeScreen} />\n      <Screen options={options} name=\"Details\" component={DetailsScreen} />\n    </Navigator>\n  );\n}\n")),Object(i.b)("p",null,"Create your two screens which we will transition to and from them. The homescreen, found in ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/callstack/react-native-testing-library/blob/master/examples/reactnavigation/src/screens/HomeScreen.js"}),Object(i.b)("inlineCode",{parentName:"a"},"./screens/HomeScreen.js")),", contains a list of elements presented in a list view. On tap of any of these items will move to the details screen with the item number:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-jsx"}),"import * as React from 'react';\nimport {\n  Text,\n  View,\n  FlatList,\n  TouchableOpacity,\n  StyleSheet,\n} from 'react-native';\n\nexport default function HomeScreen({ navigation }) {\n  const [items] = React.useState(\n    new Array(20).fill(null).map((_, idx) => idx + 1)\n  );\n\n  const onOpacityPress = (item) => navigation.navigate('Details', item);\n\n  return (\n    <View>\n      <Text style={styles.header}>List of numbers from 1 to 20</Text>\n      <FlatList\n        keyExtractor={(_, idx) => `${idx}`}\n        data={items}\n        renderItem={({ item }) => (\n          <TouchableOpacity\n            onPress={() => onOpacityPress(item)}\n            style={styles.row}\n          >\n            <Text>Item number {item}</Text>\n          </TouchableOpacity>\n        )}\n      />\n    </View>\n  );\n}\n\nconst divider = '#DDDDDD';\n\nconst styles = StyleSheet.create({\n  header: {\n    fontSize: 20,\n    textAlign: 'center',\n    marginVertical: 16,\n  },\n  row: {\n    paddingVertical: 16,\n    paddingHorizontal: 24,\n    borderBottomColor: divider,\n    borderBottomWidth: 1,\n  },\n});\n")),Object(i.b)("p",null,"The details screen, found in ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/callstack/react-native-testing-library/blob/master/examples/reactnavigation/src/screens/DetailsScreen.js"}),Object(i.b)("inlineCode",{parentName:"a"},"./screens/DetailsScreen.js")),", contains a header with the item number passed from the home screen:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-jsx"}),"// ./screens/DetailsScreen.js\nimport * as React from 'react';\nimport { Text, StyleSheet, View } from 'react-native';\n\nexport default function DetailsScreen(props) {\n  const item = Number.parseInt(props.route.params, 10);\n\n  return (\n    <View>\n      <Text style={styles.header}>Showing details for {item}</Text>\n      <Text style={styles.body}>the number you have chosen is {item}</Text>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  header: {\n    fontSize: 20,\n    textAlign: 'center',\n    marginVertical: 16,\n  },\n  body: {\n    textAlign: 'center',\n  },\n});\n")),Object(i.b)("h2",{id:"setting-up-the-test-environment"},"Setting up the test environment"),Object(i.b)("p",null,"Install required dev dependencies:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{}),"$ yarn add -D jest @testing-library/react-native\n")),Object(i.b)("p",null,"Create your ",Object(i.b)("inlineCode",{parentName:"p"},"jest.config.js")," file (or place the following properties in your ",Object(i.b)("inlineCode",{parentName:"p"},"package.json"),' as a "jest" property)'),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-js"}),"module.exports = {\n  preset: 'react-native',\n  setupFiles: ['./node_modules/react-native-gesture-handler/jestSetup.js'],\n  transformIgnorePatterns: [\n    'node_modules/(?!(jest-)?react-native|@react-native-community|@react-navigation)',\n  ],\n};\n")),Object(i.b)("p",null,"Notice the 2 entries that don't come with the default React Native project:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"setupFiles")," \u2013 an array of files that Jest is going to execute before running your tests. In this case, we run ",Object(i.b)("inlineCode",{parentName:"li"},"react-native-gesture-handler/jestSetup.js")," which sets up necessary mocks for ",Object(i.b)("inlineCode",{parentName:"li"},"react-native-gesture-handler")," native module"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("inlineCode",{parentName:"li"},"transformIgnorePatterns")," \u2013 an array of paths that Jest ignores when transforming code. In this case, the negative lookahead regular expression is used, to tell Jest to transform (with Babel) every package inside ",Object(i.b)("inlineCode",{parentName:"li"},"node_modules/")," that starts with ",Object(i.b)("inlineCode",{parentName:"li"},"react-native"),", ",Object(i.b)("inlineCode",{parentName:"li"},"@react-native-community")," or ",Object(i.b)("inlineCode",{parentName:"li"},"@react-navigation")," (added by us, the rest is in ",Object(i.b)("inlineCode",{parentName:"li"},"react-native")," preset by default, so you don't have to worry about it).")),Object(i.b)("p",null,"For this example, we are going to test out two things. The first thing is that the page is laid out as expected. The second, and most important, is that the page will transition to the detail screen when any item is tapped on."),Object(i.b)("p",null,"Let's add a ",Object(i.b)("a",Object(a.a)({parentName:"p"},{href:"https://github.com/callstack/react-native-testing-library/blob/master/examples/reactnavigation/src/__tests__/AppNavigator.js"}),Object(i.b)("inlineCode",{parentName:"a"},"AppNavigator.test.js"))," file in ",Object(i.b)("inlineCode",{parentName:"p"},"src/__tests__")," directory:"),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-jsx"}),"import * as React from 'react';\nimport { NavigationContainer } from '@react-navigation/native';\nimport { render, fireEvent } from '@testing-library/react-native';\n\nimport AppNavigator from '../AppNavigator';\n\n// Silence the warning https://github.com/facebook/react-native/issues/11094#issuecomment-263240420\njest.mock('react-native/Libraries/Animated/src/NativeAnimatedHelper');\n\ndescribe('Testing react navigation', () => {\n  test('page contains the header and 10 items', async () => {\n    const component = (\n      <NavigationContainer>\n        <AppNavigator />\n      </NavigationContainer>\n    );\n\n    const { findByText, findAllByText } = render(component);\n\n    const header = await findByText('List of numbers from 1 to 20');\n    const items = await findAllByText(/Item number/);\n\n    expect(header).toBeTruthy();\n    expect(items.length).toBe(10);\n  });\n\n  test('clicking on one item takes you to the details screen', async () => {\n    const component = (\n      <NavigationContainer>\n        <AppNavigator />\n      </NavigationContainer>\n    );\n\n    const { findByText } = render(component);\n    const toClick = await findByText('Item number 5');\n\n    fireEvent(toClick, 'press');\n    const newHeader = await findByText('Showing details for 5');\n    const newBody = await findByText('the number you have chosen is 5');\n\n    expect(newHeader).toBeTruthy();\n    expect(newBody).toBeTruthy();\n  });\n});\n")),Object(i.b)("h2",{id:"running-tests"},"Running tests"),Object(i.b)("p",null,"To run the tests, place a test script inside your ",Object(i.b)("inlineCode",{parentName:"p"},"package.json")),Object(i.b)("pre",null,Object(i.b)("code",Object(a.a)({parentName:"pre"},{className:"language-json"}),'{\n  "scripts": {\n    "test": "jest"\n  }\n}\n')),Object(i.b)("p",null,"And run the ",Object(i.b)("inlineCode",{parentName:"p"},"test")," script with ",Object(i.b)("inlineCode",{parentName:"p"},"npm test")," or ",Object(i.b)("inlineCode",{parentName:"p"},"yarn test"),"."))}p.isMDXComponent=!0},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d}));var a=n(0),r=n.n(a);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=r.a.createContext({}),p=function(e){var t=r.a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):c({},t,{},e)),n},b=function(e){var t=p(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),b=p(n),u=a,d=b["".concat(o,".").concat(u)]||b[u]||m[u]||i;return n?r.a.createElement(d,c({ref:t},l,{components:n})):r.a.createElement(d,c({ref:t},l))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=u;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c.mdxType="string"==typeof e?e:a,o[1]=c;for(var l=2;l<i;l++)o[l]=n[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);